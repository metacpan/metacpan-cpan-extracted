name    = Test-JSON-Schema-Acceptance
author  = Ben Hutton (@relequestual) <relequest@cpan.org>
license = MIT
copyright_year = 2015
copyright_holder = Ben Hutton

; bring local checkout up to what the submodule commit says
[Run::BeforeBuild]
run = git submodule update --init --recursive
run = git submodule update --recursive  ; fetches the commit captured in 'share'

; if there are new changes to the submodule, release is halted
[Run::BeforeRelease]
run = git submodule update --remote     ; updates to the latest commit in the submodule repository

[@Author::ETHER]
:version = 0.154    ; submodules, github issues
authority = cpan:RELEQUEST
bugtracker = github
installer = =inc::MakeMaker
Test::MinimumVersion.max_target_perl = 5.014 ; s///r
Git::GatherDir.exclude_filename = share ; in git, this is a filename (containing submodule info)
StaticInstall.mode = off    ; sharedir
Test::ReportPrereqs.include[0] = JSON::PP
Test::ReportPrereqs.include[1] = Cpanel::JSON::XS
Test::ReportPrereqs.include[2] = JSON::XS

[Prereqs / DevelopRequires]
Test::Warnings = 0

[Git::GatherDir / Gather sharedir]
root = share
prefix = share
exclude_filename = index.js
exclude_filename = package.json
exclude_filename = tox.ini
exclude_match = ^bin/

[GenerateFile]
filename = share/submodule_status
content_is_template = 1
content = {{
content =   chomp(my $str = `git submodule status`);
content =   my ($sha, undef, $tag) = split(' ', $str);
content =   chomp(my $url = `git config  --file .gitmodules submodule.share.url`);
content =   $sha.' '.$tag."\n".$url;
content = }}

[ShareDir]
dir = share
