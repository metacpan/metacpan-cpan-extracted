#!/bin/bash

set -ex

if [ "x$CIP_ENV" == "x" ]; then
  echo "please set CIP_ENV to one of:"
  echo " export CIP_ENV=ALIEN_INSTALL_TYPE=share"
  echo " export CIP_ENV=ALIEN_INSTALL_TYPE=system"
  false
fi

if echo $CIP_ENV | grep -q system; then
  echo use system curl
  cip sudo apt-get update
  cip sudo apt-get -y install libcurl4-openssl-dev libffi-dev
else
  echo use internet curl
  cip sudo apt-get update
  cip sudo apt-get -y install g++ libffi-dev
fi

cip exec env ALIEN_INSTALL_TYPE=default cpanm -n FFI::Platypus
