
<html><head>
    <title>HTML::Template::Compiled::Plugin::InlineImage example</title>
</head>
<body bgcolor="#dddddd">

<h2>Images</h2>
<br>PNG:  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAgMAAAF6i01RAAAADFBMVEX///8AAP//AAAAAACOfuOx
AAAAAXRSTlMAQObYZgAAAgRJREFUCJnNVEtuwjAQnRTRBQdgkSOw8hGQuEClli5yhKx6BI6AVLpn
ESSYUwQWLDhCj9BVb5DO+BN73NiiFZU6EjEvz36eeWMHuq5roQWKtl4BnHEPcEEE+LCPFT/mBl7w
AHDCLdgV/CAB0EGTJtjAjBRmNBnpV9OP/5f07o6X2WjjccKzAY40kAQnoF+861FvjpyJe3/iYc8p
07hmnZqHXq/T0UI6alKlmGgZhrwN5Uix1a81UfJIJc/svteObp3Tcbpun35fl0ci2h+hosK3HukU
tCmE7hGtk4QKCzhB4zxae42fJhrbjX7q2SPSuQRolUVyndSU+0W5yDxlDVF9Ue1XetYF8SkYdUM0
rk1mGhVc8Mah0hXEqOh9UD3FJCNn05pR70vDyNlCLim/jBYqv4wWEvLOb5UXIRllzqeJvfKSJKrA
NwUxRmWAXn6NcjvIXGSesgZZX1S79EV6Jv2UXkd9kD2S/Yt6K/t+85PVwnCM/hVTLJfLhwFmXBn7
n2Lmue/Tbi6YKjgVh3nATDGMnWfGKGPjmKKOGHywzDQmWE8z35Zw20fBVymMRjPlAHNgphgg6LgR
MyRGcsQMiZEcMdUwswi/rSIWcEwwj+HXWcTrrZlkBumsM5Wm3Uk7mu5CunOZbqdPSOZUpU9i+vRm
TnzmlmRuVuY2Zm5w7tb/LdOl4gul/wX5j6LQ6QAAAABJRU5ErkJggg==
" width="100" height="100" alt="test">
<br>PNG:  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkAgMAAAF6i01RAAAADFBMVEX///8AAP//AAAAAACOfuOx
AAAAAXRSTlMAQObYZgAAAgRJREFUCJnNVEtuwjAQnRTRBQdgkSOw8hGQuEClli5yhKx6BI6AVLpn
ESSYUwQWLDhCj9BVb5DO+BN73NiiFZU6EjEvz36eeWMHuq5roQWKtl4BnHEPcEEE+LCPFT/mBl7w
AHDCLdgV/CAB0EGTJtjAjBRmNBnpV9OP/5f07o6X2WjjccKzAY40kAQnoF+861FvjpyJe3/iYc8p
07hmnZqHXq/T0UI6alKlmGgZhrwN5Uix1a81UfJIJc/svteObp3Tcbpun35fl0ci2h+hosK3HukU
tCmE7hGtk4QKCzhB4zxae42fJhrbjX7q2SPSuQRolUVyndSU+0W5yDxlDVF9Ue1XetYF8SkYdUM0
rk1mGhVc8Mah0hXEqOh9UD3FJCNn05pR70vDyNlCLim/jBYqv4wWEvLOb5UXIRllzqeJvfKSJKrA
NwUxRmWAXn6NcjvIXGSesgZZX1S79EV6Jv2UXkd9kD2S/Yt6K/t+85PVwnCM/hVTLJfLhwFmXBn7
n2Lmue/Tbi6YKjgVh3nATDGMnWfGKGPjmKKOGHywzDQmWE8z35Zw20fBVymMRjPlAHNgphgg6LgR
MyRGcsQMiZEcMdUwswi/rSIWcEwwj+HXWcTrrZlkBumsM5Wm3Uk7mu5CunOZbqdPSOZUpU9i+vRm
TnzmlmRuVuY2Zm5w7tb/LdOl4gul/wX5j6LQ6QAAAABJRU5ErkJggg==
" width="100" height="100" alt="test">
<br>GIF:  <img src="data:image/gif;base64,R0lGODlhZABkAKEAAP///wAAAP8AAAAA/yH5BAEAAAAALAAAAABkAGQAAAL+jI+py+0PowO02ouz
3rz7nxngSJamKZ7qyo5pC8fwK9c2SN/6buX8b/MBhy0h8YgKIJcrI/O5cUKnPeVzgM1qt0+pbDsQ
iMfkMnjoZWnL7HZby0ub1u66fQwPWmPZu/+PhyUj54EFeIgoWLSnYoj4eKioQqgRBnkZ2cRI4ojp
6SdJQlnR+Wl6F/oxClB66uqW2kHZ91pbl4WzudFq22s2oKqbwetbLBaLkUZsbIxc1bHM3AwcJWxh
KZ1NRq0hha0NLsCdbM0afn7cbf2NDj5eYcTenv1OISQ/T0+OgZ+v/3ytnz9moXIIHEgQICmE7cbR
OMiwGTxGECP64vYimsX+Yooybmxob0/Fj7aoeSQZzqQVjShLAksxsuWrlytlpgQA06Y7nDV16svp
UxpNCjGDYhpqzqhEoEov8iTalONTVkWj/hF00qorlQu1bg3Z1asprkSrimXTkeJZTxjVrr3U9oLZ
tw43zV1bV+5drwV17dX67t7bq/uGDbZTbyq/w7dClPvrM7Fiw4zxVINWWRwHLyybOgMLDbLFz6BD
45Ws0DRf1KlDi0aHK1iJzqNZF+b0mp7t27NzX9ztWA1K4Opa0NZG2sOqSr7hEt9cbs7xrcldRG9E
q1eeGstH0BkbW0f33t9BcQEyXg2Y9c8HXacyJT38OO/nM5Fv/wb+/Nwe6/Mnst9/M/gn4A8BFqgJ
gvAdqGASEjwIYYQSTlgAADs=
" width="100" height="100" alt="test">
<br>JPEG: <img src="data:image/jpeg;base64,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
UKFChXI2BAoaLX59c//Z
" width="100" height="100" alt="test">

<hr>
<h2>The Template:</h2>
<table border=1 bgcolor="#ffffff"><tr><td>
<pre>
&lt;html&gt;&lt;head&gt;
    &lt;title&gt;HTML::Template::Compiled::Plugin::InlineImage example&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#dddddd&quot;&gt;

&lt;h2&gt;Images&lt;/h2&gt;
&lt;br&gt;PNG:  &lt;img &lt;%= gd escape=INLINE_IMG %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;PNG:  &lt;img &lt;%= gd escape=INLINE_IMG_PNG %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;GIF:  &lt;img &lt;%= gd escape=INLINE_IMG_GIF %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;JPEG: &lt;img &lt;%= gd escape=INLINE_IMG_JPEG %&gt; alt=&quot;test&quot;&gt;

&lt;hr&gt;
&lt;h2&gt;The Template:&lt;/h2&gt;
&lt;table border=1 bgcolor=&quot;#ffffff&quot;&gt;&lt;tr&gt;&lt;td&gt;
&lt;pre&gt;&lt;%= template escape=html %&gt;&lt;/pre&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;hr&gt;
&lt;h2&gt;The whole script:&lt;/h2&gt;
&lt;table border=1 bgcolor=&quot;#ffffff&quot;&gt;&lt;tr&gt;&lt;td&gt;
&lt;pre&gt;&lt;%= code escape=html %&gt;&lt;/pre&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</pre>
</td></tr></table>

<hr>
<h2>The whole script:</h2>
<table border=1 bgcolor="#ffffff"><tr><td>
<pre>#!/usr/bin/perl
use strict;
use warnings;
use blib;
use GD;
use HTML::Template::Compiled 0.73;
use HTML::Template::Compiled::Plugin::InlineImage;
use Fcntl qw(:seek);

# ---------- GD --------------
# create a new image
my $im = new GD::Image( 100, 100 );

# allocate some colors
my $white = $im-&gt;colorAllocate( 255, 255, 255 );
my $black = $im-&gt;colorAllocate( 0,   0,   0 );
my $red   = $im-&gt;colorAllocate( 255, 0,   0 );
my $blue  = $im-&gt;colorAllocate( 0,   0,   255 );

# make the background transparent and interlaced
$im-&gt;transparent($white);
$im-&gt;interlaced('true');

# Put a black frame around the picture
$im-&gt;rectangle( 0, 0, 99, 99, $black );

# Draw a blue oval
$im-&gt;arc( 50, 50, 95, 75, 0, 360, $blue );

# And fill it with red
$im-&gt;fill( 50, 50, $red );

# make sure we are writing to a binary stream
binmode STDOUT;
my ($width,$height) = $im-&gt;getBounds();
#print &quot;($width,$height)\n&quot;;
# Convert the image to PNG and print it on standard output
# my $bin = $im-&gt;png;

# ---------- HTC ----------------
my $template;
my $script;
$HTML::Template::Compiled::Plugin::InlineImage::SIZE_WARNING = 0;
{
    local $/;
    $template = &lt;DATA&gt;;
    seek DATA, 0, SEEK_SET;
    $script = &lt;DATA&gt;;
}
my $htc = HTML::Template::Compiled-&gt;new(
    scalarref =&gt; \$template,
    debug =&gt; 0,
    plugin =&gt; [qw(HTML::Template::Compiled::Plugin::InlineImage)],
);
$htc-&gt;param(
    gd =&gt; $im,
    template =&gt; $template,
    code =&gt; $script,
);
print $htc-&gt;output;

__DATA__

&lt;html&gt;&lt;head&gt;
    &lt;title&gt;HTML::Template::Compiled::Plugin::InlineImage example&lt;/title&gt;
&lt;/head&gt;
&lt;body bgcolor=&quot;#dddddd&quot;&gt;

&lt;h2&gt;Images&lt;/h2&gt;
&lt;br&gt;PNG:  &lt;img &lt;%= gd escape=INLINE_IMG %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;PNG:  &lt;img &lt;%= gd escape=INLINE_IMG_PNG %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;GIF:  &lt;img &lt;%= gd escape=INLINE_IMG_GIF %&gt; alt=&quot;test&quot;&gt;
&lt;br&gt;JPEG: &lt;img &lt;%= gd escape=INLINE_IMG_JPEG %&gt; alt=&quot;test&quot;&gt;

&lt;hr&gt;
&lt;h2&gt;The Template:&lt;/h2&gt;
&lt;table border=1 bgcolor=&quot;#ffffff&quot;&gt;&lt;tr&gt;&lt;td&gt;
&lt;pre&gt;&lt;%= template escape=html %&gt;&lt;/pre&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;

&lt;hr&gt;
&lt;h2&gt;The whole script:&lt;/h2&gt;
&lt;table border=1 bgcolor=&quot;#ffffff&quot;&gt;&lt;tr&gt;&lt;td&gt;
&lt;pre&gt;&lt;%= code escape=html %&gt;&lt;/pre&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</pre>
</td></tr></table>
</body></html>
