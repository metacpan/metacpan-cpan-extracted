#!/usr/bin/env perl

use strict;
use warnings;

use lib 'definitions';

use Zing::Process;
use Zing::Registry;

=pod explain

- zing-registry is a key/val data store specifically for registering processes
- the default registry name is "default" but can be anything you like ...
- in the event that you need a separate registry for some other work

=cut

my @p;
my $r = Zing::Registry->new(name => 'convention');

for my $i (1..1_000) {
  push @p, my $p = Zing::Process->new;
  warn $p->name, ' ', 'registered', ' ', $r->send($p);
}

for my $x (@p) {
  my $q = $r->recv($x); $r->drop($x);
  warn $q->{name}, ' ', 'unregistered';
}

warn 'registry saved at', ' ', $r->term;
