Name:           perl-Logfile-Tail
Version:        0.9
Release:        1%{?dist}
Summary:        Tail log files
License:        GPLv2+ and Artistic 2.0
Group:          Development/Libraries
URL:            http://www.adelton.com/perl/Logfile-Tail/
Source0:        http://www.adelton.com/perl/Logfile-Tail/Logfile-Tail-%{version}.tar.gz
BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
BuildArch:      noarch
BuildRequires:  make
%if 0%{?rhel} > 7 || 0%{?rhel} == 0
BuildRequires:  perl-generators
%endif
BuildRequires:  perl-interpreter
BuildRequires:  perl(Digest::SHA)
BuildRequires:  perl(ExtUtils::MakeMaker)
BuildRequires:  perl(Test::More)
Requires:       perl(Digest::SHA)
Requires:       perl(Test::More)
Requires:       perl(:MODULE_COMPAT_%(eval "`%{__perl} -V:version`"; echo $version))

%description
Log files are files that are generated by various running programs. They
are generally only appended to. When parsing information from log files, it
is important to only read each record / line once, both for performance and
for accounting and statistics reasons.

%prep
%setup -q -n Logfile-Tail-%{version}

%build
%{__perl} Makefile.PL INSTALLDIRS=vendor
make %{?_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT

make pure_install PERL_INSTALL_ROOT=$RPM_BUILD_ROOT

find $RPM_BUILD_ROOT -type f -name .packlist -exec rm -f {} \;
find $RPM_BUILD_ROOT -depth -type d -exec rmdir {} 2>/dev/null \;

%{_fixperms} $RPM_BUILD_ROOT/*

%check
make test

%files
%defattr(-,root,root,-)
%{_bindir}/logfile-tail
%doc
%{perl_vendorlib}/*
%{_mandir}/man1/*
%{_mandir}/man3/*

%changelog
* Fri Aug 16 2024 Jan Pazdziora 0.9-1
- Clear the EOF flag to allow for repeated read,
  fixing compatibility issue with latest perls.

* Tue Mar 13 2012 Jan Pazdziora 0.7-1
- Renamed module to Logfile::Tail and the script to logfile-tail.

* Tue Mar 13 2012 Jan Pazdziora 0.6-1
- Specfile autogenerated by cpanspec 1.78, with manual tweaks.
